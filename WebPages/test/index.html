<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<Head>
<Title>OnStream SCSI Tape driver for Linux tester's page</Title>
	<Link HRef="mailto:osst@linux1.onstream.nl">
	<Meta HTTP-Equiv="Content-Type" Content="text/html; charset=iso-8859-1">
	<Meta Name="Author" Content="garloff@suse.de">
	<Meta Name="Generator" Content="Text Editor (xemacs/jed, Linux)">
	<Meta Name="Keywords" Content="OnStream SCSI Tape SC-30 SC-50 ADR">
	<Meta Name="Description" Content="osst tester page"> 
</Head>
<Body Background="/gif/bg_pingu.gif" BGColor=#f0f0f0>
<A HRef=".."><Img Src="/gif/left.gif" Align=middle Alt="Back" Width=16 Height=16>
Back</A>
<Center><H1>OSST tester's page</H1></Center>
This page should give some info to potential testers of the kernelspace
driver for the OnStream SC-30/50 tape devices.
<H3>Driver</H3>
The kernelspace solution to drive the SC-x0 has been created by copying the
original scsi tape driver <TT>st</TT> of Kai Mikasara to <TT>osst</TT> and
changing it in order to support the OnStream device. When being loaded, it
allows to access the OnStream tape via <TT>/dev/st?</TT> just like normal
tapes using <TT>mt</TT>, <TT>tar</TT>, <TT>amanda</TT>, ... <Br>
The driver currently supports 2.2.1x kernels. A 2.4 version is also
available.

<H3>Status</H3>
<P>The driver does not have production quality yet and a few problems are
known or to be expected.<Br>
DISCLAIMER: If you test it, you do it on your own risk. If the driver
crashes your kernel (unlikely, but possible) and you loose important data,
you are on your own. If you use the driver to backup your data and need to
restore it later, but fail, you are on your own again. If something bad
happens to you because of this driver, don't even try to make somebody
responsible for this. There is no warranty of whatever kind. In short:
<EM>The <A HRef="http://www.fsf.org/copyleft/gpl.html">GNU GPL</A>
applies.</EM></P>

<P>Here comes a list with status updates:
<DL>
<DT>2000-04-05: (osst 0.6.3)</DT>
<DD>The first public ALPHA release for the adventureous testers.</DD>
<DT>2000-04-17: (osst 0.6.4)</DT>
<DD>Should fix the blocking problem.</DD>
<DT>2000-05-02: (osst 0.7.0)</DT>
<DD>Added the "fast open" feature: The headers are cached and if the tape
has not been changed, they don't need to be reread. A list of filesmarks is
now kept in the headers: LIN4 signature. Automatic conversion on write.
Better error recovery.</DD>
<DT>2000-05-14: (osst 0.7.1)</DT>
<DD>Bugfixes. Maintains soft error count.
Successfully tested with firmware 1.05 and 1.08.</DD>
<DT>2000-05-15: (osst 0.7.2)</DT>
<DD>Fix error handling skipping over second header group.</DD>
<DT>2000-05-21: (osst 0.7.3)</DT>
<DD>Fix I/O error on read after seek.</DD>
<DT>2000-05-24: (osst 0.7.9)</DT>
<DD>On own character device (major 206) has been registered. The driver has
been adapted to use it and is now able to coexist with st. (Mostly untested,
sorry!) A <A HRef="README.osst">README.osst</A> file has been added. Some
test's and we'll be ready for BETA!</DD>
<DT>2000-05-27: (osst 0.7.91)</DT>
<DD>Osst coexistance with st in the 2.2.15 kernel tree has now been tested.
After applying the osst-22.diff patch you will find in the sources (see
Download below) st will no longer detect OnStream tape drives other than
the ADR series (which do not need osst). Copy in osst.[ch] as explained in
the README, compile and install a new kernel as usual, create the osst devices
and try it out!</DD>
<DT>2000-06-11: (osst 0.7.99)</DT>
<DD>Adopted ADR 1.4 Tape Format, which standardizes the location of file mark
lists in the Header and disambiguates terminology.</DD>
<DT>2000-06-21: (osst 0.7.99a)</DT>
<DD>Slight changes to the way it is integrated into the kernel. Both osst
and st now use the OSST_SUPPORTS(SDp) macro provided by osst_detect.h in
both detect() and attach(). Kernel patch is against 2.2.16 now.</DD>
<DT>2000-06-25: (osst 0.8.0)</DT>
<DD>BETA Test candidate!
Options can now independently be set in osst_options.h (non-applicable options
from st are dropped). Osst.c now identifies the tape drive with a unique code
rather than as a generic SCSI2 drive.</DD>
<DT>2000-07-16: (osst 0.8.1)</DT>
<DD>Improved handling of opening the device after a 'mt offline'.
Driver now returns error ENOSPC 164 blocks before reaching tape capacity.
This should make volume spanning work now. The 164 blocks allows for two
write errors to be recovered at the end of tape.</DD>
<DT>2000-07-24: (osst 0.8.1 / 0.9.0p1)</DT>
<DD>The 2.4 test version is out there (0.9.0p1)!</DD>
<DT>2000-08-12: (osst 0.8.2 / 0.9.0p2)</DT>
<DD>osst_int_ioctl now uses the Scsi_Cmnd structure allocated by the
caller, as allocating a new one hangs the driver on resource
challenged installations.</DD>
<DT>2000-08-12: (osst 0.8.2 / 0.9.0)</DT>
<DD>Beta test version 0.9.0 for linux-2.4.0-test6.</DD>
<DT>2000-09-24: (osst 0.8.4 / 0.9.2)</DT>
<DD>The drive now ejects the tape with 'mt offline'. Fixed polling algorithm 
in preparation of supporting IDE and USB drives. Osst 0.9.2 needs the version 
of st found in kernel versions 2.4.0-test9-pre6 and later.</DD>
<DT>2000-10-04: (osst 0.8.5 / 0.9.3)</DT>
<DD>Some bugfixes. 0.9.3 now verified to support USB Onstream drives and
big endian platforms such as the Power PC.</DD>
<DT>2000-10-29: (osst 0.8.6 / 0.9.4)</DT>
<DD>Deal with the complications of read errors occurring near but not at the location where
a recovered write error occurred. Better handling of rewriting part of a tape (not recommended).
Made sure tape is left in a suitable position and state when reposition commands fail.</DD>
<DT>2000-12-09: (osst 0.8.7)</DT>
<DD>This version implements blocksizes less than 32k. The default at startup is 512 bytes.
You can change it like this: 'mt defblksize 1024' 
or another size (that divides into 32k) of your choice.
The blocksize for files written is determined by the
default at the time of open. I don't allow changes
during a write.
The blocksize for reading is set to the size used to
write it when you start reading.</DD>
<DT>2000-12-11: (osst 0.8.8)</DT>
<DD>Fixed bug when write error is detected during polling.</DD>
<DT>2000-12-20: (osst 0.8.6.1 / 0.9.4.2)</DT>
<DD>Ported the bugfix which went into 0.8.8 to the versions with a fixed
block size of 32k.</DD>
<DT>2000-12-22: (osst 0.8.6.1 / 0.9.4.3)</DT>
<DD>0.9.4.2 could not be compiled statically into the kernel. Fixed.</DD>
<DT>2001-01-03: (osst 0.8.9)</DT>
<DD>Preceed locate(3000) with locate(0) because some drives go AWOL when they mistakenly
detect BOT during such a locate.</DD>
<DT>2001-01-25: (osst 0.8.10 / 0.9.5)</DT>
<DD>Osst 0.9.5 is for the released kernel 2.4.0. It has now caught up with the version for the
2.2.x kernels and implements blocksizes less than 32k. The locate(0) above should not have been
applied during write error recovery - corrected. Some log output has been rationalized.
Note that recent official kernel trees do now include osst and to upgrade them to these
versions all you need to do is copy the new osst.c and osst.h into /usr/src/linux/drivers/scsi
and re-run 'make modules modules_install'.</DD>
</DL></P>

<H3>Known problems as of <B>0.8.10 / 0.9.5</B></H3>
<UL>
<LI>Currently none.</LI>
</UL>

<H3>Feedback</H3>
<P>Please report any problems to the 
<A HRef="mailto:osst@linux1.onstream.nl">osst mailing list 
<TT>&lt;osst@linux1.onstream.nl&gt;</TT></A>. The
developers (and soon hopefully other testers) will be reading your report
and potentially ask for more details and try to solve the problem.</P>
<P>Useful bug reports include some info:
<UL>
<LI>What is the problem? (e.g. wrong data is being read) What conditions?
(e.g. tape has been written by userspace onstreamsg-0.9.13) What symptoms?
What related effects? (e.g. kernel crashes afterwards)</LI>
<LI>What driver has been used? What version? What is the firmware revision
of the tape device?</LI>
<LI>Is the bug reproducible?</LI>
<LI>Is the same bug present in the <A HRef="ftp://ftp.orcas.net/pub/linux/onstream/">
userspace driver <TT>osg</TT></A>?</LI>
</UL>
Of course, you are also welcome to report successful operation of the
driver.<Br> Please don't send general Linux SCSI questions to the list.
</P>
<P>Note that the mailing list is open for subscription. Please send your
subscribe request to 
<A HRef="mailto:osst-request@linux1.onstream.nl"><TT>osst-request@linux1.onstream.nl</TT></A>.
It's a majordomo list. If you're not yet experienced with this kind of
lists, start with sending a mail with just <TT>help</TT> in the
<em>body</em> of the mail to <TT>osst<B>-request</B></TT>.
</P>
<P>The list currently is both open for subscription and postings by
non-subscribers. We do hope that there won't be spam, which would force us to 
impose restrictions.</P>

<H3>Download</H3>
There are several possibilities to get the <TT>osst</TT>-driver. For your
convenience, the archives also contain Terry's userspace driver <TT>osg</TT> 
and some tools.
<OL>
<LI>(recommended) Get the very latest <A HRef="onstream-20010125.tar.gz">sources</A>, unpack
them (<TT>tar xvzf onstream-200*.tar.gz</TT>) and compile the driver (<TT>cd
onstream/driver; make</TT>). This only works, if you have a configured Linux source
tree (apply patch osst-22.diff resp. osst-24.diff first) installed in
<TT>/usr/src/linux/</TT>. Alternatively, here are the 
<A HRef="onstream-0861-0943.tar.gz">sources for 0.8.6.1/0.9.4.3</A>, the
latest stable versions with a fixed blocksize of 32k used in the RPMS below.
<Br>
To install the driver, do a <TT>make install</TT>, and the driver will be
copied to <TT>/lib/modules/2.2.1?/scsi/</TT> resp.
<TT>/lib/modules/2.4.0-test?/scsi/</TT>. You need root permissions for
this. You can now load the driver (module) by using <TT>modprobe</TT> and
unload it with <TT>rmmod</TT>.<Br>
If this all looks new and scary to you: Sorry! You may be able to help us
later, when the driver is getting better and better, but right now, you
should better first get familiar with your Linux Operating System, the
kernel, the modules, etc.</LI>
<LI>If you happen to use a ix86 machine with a 2.2.16 Linux kernel 
<!--(e.g. in SuSE Linux 6.4)--> and a glibc-2.1 based distribution, you should be
able to install and use the <A HRef="onstream-0.9.13_0.8.6.1-0.i386.rpm">onstream RPM</A>
<!--from SuSE-->. Install with <TT>rpm -i</TT> or update with <TT>rpm -U</TT>.
If you have a different arch, kernel or libc, you will probably be able to get the
thing to work by getting the <A HRef="onstream-0.9.13_0.8.6.1-0.src.rpm">source RPM</A>
and recompile it with <TT>rpm --recompile</TT>. This package actually is an
(updated) RPM provided by <A HRef="http://www.suse.com/">SuSE</A>
<A HRef="http://www.suse.com/us/products/susesoft/70news/">Linux 7.0</A>.
</OL>
If you download and use this driver, you agree to do so under the terms of
the <A HREf="http://www.fsf.org/copyleft/">GNU GPL</A>.
<!--
<P>Note: It seems that there is a distribution (Debian) which for unknown
reasons ships without device nodes <TT>/dev/st0</TT> for SCSI tapes. If you
miss those, please create them (as root) using
<TT><Pre>
mknod /dev/st0  c 9 0
mknod /dev/nst0 c 9 128
mknod /dev/st1  c 9 1
mknod /dev/nst1 c 9 129
</Pre></TT>
and adjust the permissions according to your needs. (Here, it's
<TT>root.disk 660</TT>).
-->
</P>

<H3>Credits</H3>
<A HRef="../developers.html">Credits</A> go to Willem Riede for developing
this driver. Some contributions come from me, Terry Hardie, and Kai Mikasara,
and some of the code was designed after Gadi Oxman's DI-30 (IDE) driver.
Jack Bombeeck did always support this project very well.<Br>
Thanks also to all the testers which provided useful info for debugging
problems and suggestions for improving the driver.

<!--<P>
<Img Src="/gif/construction.gif" Alt="under construction" Width=40 Height=32>
</P>-->
<HR>
<I>(w) by <A HRef="mailto:garloff@suse.de">KG</A>, $Id$</I>
</Body>
</HTML>
