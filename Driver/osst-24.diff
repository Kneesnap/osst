diff -ur linux-2.4.0-orig/MAINTAINERS linux-2.4.0-test3-pre2/MAINTAINERS
--- linux-2.4.0-orig/MAINTAINERS	Sat Jul  1 20:53:49 2000
+++ linux-2.4.0-test3-pre2/MAINTAINERS	Sat Jul  1 22:04:13 2000
@@ -799,6 +799,13 @@
 W:	http://www.linuxtr.net
 S:	Maintained
 
+ONSTREAM SCSI TAPE DRIVER
+P:	Willem Riede
+M:	wriede@monmouth.com
+L:	osst@linux1.onstream.nl
+L:	linux-scsi@vger.rutgers.edu
+S:	Maintained
+
 OPL3-SA2, SA3, and SAx DRIVER
 P:	Scott Murray
 M:	scott@spiteful.org
diff -ur linux-2.4.0-orig/drivers/scsi/Config.in linux-2.4.0-test3-pre2/drivers/scsi/Config.in
--- linux-2.4.0-orig/drivers/scsi/Config.in	Mon Mar 27 12:45:33 2000
+++ linux-2.4.0-test3-pre2/drivers/scsi/Config.in	Sat Jul  1 22:04:13 2000
@@ -8,6 +8,8 @@
 
 dep_tristate '  SCSI tape support' CONFIG_CHR_DEV_ST $CONFIG_SCSI
 
+dep_tristate '  OnStream SC-x0 SCSI tape support' CONFIG_CHR_DEV_OSST $CONFIG_SCSI
+
 dep_tristate '  SCSI CD-ROM support' CONFIG_BLK_DEV_SR $CONFIG_SCSI
 
 if [ "$CONFIG_BLK_DEV_SR" != "n" ]; then
diff -ur linux-2.4.0-orig/drivers/scsi/Makefile linux-2.4.0-test3-pre2/drivers/scsi/Makefile
--- linux-2.4.0-orig/drivers/scsi/Makefile	Tue Jun 20 17:14:51 2000
+++ linux-2.4.0-test3-pre2/drivers/scsi/Makefile	Sat Jul  1 22:04:13 2000
@@ -31,6 +31,7 @@
 
 obj-$(CONFIG_SCSI)		+= scsi_mod.o
 obj-$(CONFIG_CHR_DEV_ST)	+= st.o
+obj-$(CONFIG_CHR_DEV_OSST)	+= osst.o
 obj-$(CONFIG_BLK_DEV_SD)	+= sd.o
 obj-$(CONFIG_BLK_DEV_SR)	+= sr_mod.o
 obj-$(CONFIG_CHR_DEV_SG)	+= sg.o
diff -ur linux-2.4.0-orig/drivers/scsi/hosts.c linux-2.4.0-test3-pre2/drivers/scsi/hosts.c
--- linux-2.4.0-orig/drivers/scsi/hosts.c	Sat Jul  1 20:53:49 2000
+++ linux-2.4.0-test3-pre2/drivers/scsi/hosts.c	Sat Jul  1 22:04:13 2000
@@ -998,6 +998,9 @@
 #ifdef CONFIG_CHR_DEV_ST
     scsi_register_device(&st_template);
 #endif
+#ifdef CONFIG_CHR_DEV_OSST
+    scsi_register_device(&osst_template);
+#endif
 #ifdef CONFIG_CHR_DEV_SG
     scsi_register_device(&sg_template);
 #endif
diff -ur linux-2.4.0-orig/drivers/scsi/hosts.h linux-2.4.0-test3-pre2/drivers/scsi/hosts.h
--- linux-2.4.0-orig/drivers/scsi/hosts.h	Sat Jun 24 00:31:56 2000
+++ linux-2.4.0-test3-pre2/drivers/scsi/hosts.h	Sat Jul  1 22:36:00 2000
@@ -508,6 +508,7 @@
 
 extern struct Scsi_Device_Template sd_template;
 extern struct Scsi_Device_Template st_template;
+extern struct Scsi_Device_Template osst_template;
 extern struct Scsi_Device_Template sr_template;
 extern struct Scsi_Device_Template sg_template;
 
diff -ur linux-2.4.0-orig/drivers/scsi/osst_detect.h linux-2.4.0-test3-pre2/drivers/scsi/osst_detect.h
--- linux-2.4.0-orig/drivers/scsi/osst_detect.h	Sat Jul  1 22:04:13 2000
+++ linux-2.4.0-test3-pre2/drivers/scsi/osst_detect.h	Sat Jul  1 22:04:13 2000
@@ -0,0 +1,5 @@
+#define OSST_SUPPORTS(SDp) (! ( memcmp (SDp->vendor, "OnStream", 8) || \
+			     ( memcmp (SDp->model, "SC-", 3) && \
+			       memcmp (SDp->model, "DI-", 3) && \
+			       memcmp (SDp->model, "DP-", 3) && \
+			       memcmp (SDp->model, "USB", 3) ) ) )
diff -ur linux-2.4.0-orig/drivers/scsi/st.c linux-2.4.0-test3-pre2/drivers/scsi/st.c
--- linux-2.4.0-orig/drivers/scsi/st.c	Sat Jul  1 20:53:49 2000
+++ linux-2.4.0-test3-pre2/drivers/scsi/st.c	Sat Jul  1 22:04:13 2000
@@ -65,6 +65,8 @@
 
 #include "constants.h"
 
+#include "osst_detect.h"
+
 static int buffer_kbs;
 static int write_threshold_kbs;
 static int max_buffers = (-1);
@@ -3426,6 +3428,18 @@
 #endif
 
 
+/* Returns zero for drives not supported by this driver */
+static int st_supported(Scsi_Device * SDp)
+{
+  /* These OnStream SC drives require a special driver. The OnStream ADR* drives
+     are supported by this driver */
+  if ( OSST_SUPPORTS(SDp) )
+      return 0;
+
+  return 1;
+}
+
+
 static struct file_operations st_fops =
 {
 	read:		st_read,
@@ -3446,6 +3460,8 @@
 
 	if (SDp->type != TYPE_TAPE)
 		return 1;
+	if (!st_supported(SDp))
+		return 1;
 
 	write_lock_irqsave(&st_dev_arr_lock, flags);
 	if (st_template.nr_dev >= st_template.dev_max) {
@@ -3610,6 +3626,8 @@
 static int st_detect(Scsi_Device * SDp)
 {
 	if (SDp->type != TYPE_TAPE)
+		return 0;
+	if (!st_supported(SDp))
 		return 0;
 
 	printk(KERN_WARNING
diff -ur linux-2.4.0-orig/include/linux/blk.h linux-2.4.0-test3-pre2/include/linux/blk.h
--- linux-2.4.0-orig/include/linux/blk.h	Sat Jun 24 00:30:34 2000
+++ linux-2.4.0-test3-pre2/include/linux/blk.h	Sat Jul  1 22:35:26 2000
@@ -177,6 +177,14 @@
 #define DEVICE_ON(device)
 #define DEVICE_OFF(device)
 
+#elif (MAJOR_NR == OSST_MAJOR)
+
+#define DEVICE_NAME "onstream" 
+#define DEVICE_INTR do_osst
+#define DEVICE_NR(device) (MINOR(device) & 0x7f) 
+#define DEVICE_ON(device) 
+#define DEVICE_OFF(device) 
+
 #elif (MAJOR_NR == SCSI_CDROM_MAJOR)
 
 #define DEVICE_NAME "CD-ROM"
@@ -384,7 +392,7 @@
 
 #endif /* MAJOR_NR == whatever */
 
-#if (MAJOR_NR != SCSI_TAPE_MAJOR)
+#if (MAJOR_NR != SCSI_TAPE_MAJOR) && (MAJOR_NR != OSST_MAJOR)
 #if !defined(IDE_DRIVER)
 
 #ifndef CURRENT
diff -ur linux-2.4.0-orig/include/linux/major.h linux-2.4.0-test3-pre2/include/linux/major.h
--- linux-2.4.0-orig/include/linux/major.h	Mon Jun 19 16:42:43 2000
+++ linux-2.4.0-test3-pre2/include/linux/major.h	Sat Jul  1 22:04:13 2000
@@ -141,6 +141,8 @@
 #define MSR_MAJOR		202
 #define CPUID_MAJOR		203
 
+#define OSST_MAJOR	206	/* OnStream-SCx0 SCSI tape */
+
 /*
  * Tests for SCSI devices.
  */
diff -ur linux-2.4.0-orig/include/linux/mtio.h linux-2.4.0-test3-pre2/include/linux/mtio.h
--- linux-2.4.0-orig/include/linux/mtio.h	Sat Jun 24 00:31:27 2000
+++ linux-2.4.0-test3-pre2/include/linux/mtio.h	Sat Jul  1 22:35:44 2000
@@ -105,6 +105,8 @@
 #define MT_ISEVEREX_FT40A	0x32	/* Everex FT40A (QIC-40) */
 #define MT_ISDDS1		0x51	/* DDS device without partitions */
 #define MT_ISDDS2		0x52	/* DDS device with partitions */
+#define MT_ISONSTREAM_SC        0x61	/* OnStream SCSI tape drives (SC-x0)
+					   and SCSI emulated (DI, DP, USB) */
 #define MT_ISSCSI1		0x71	/* Generic ANSI SCSI-1 tape unit */
 #define MT_ISSCSI2		0x72	/* Generic ANSI SCSI-2 tape unit */
 
@@ -134,6 +136,7 @@
 	{MT_ISWT5099EEN24,	"Wangtek 5099-een24, 60MB"}, \
 	{MT_ISTEAC_MT2ST,	"Teac MT-2ST 155mb data cassette drive"}, \
 	{MT_ISEVEREX_FT40A,	"Everex FT40A, QIC-40"}, \
+	{MT_ISONSTREAM_SC,      "OnStream SC-, DI-, DP-, or USB tape drive"}, \
 	{MT_ISSCSI1,		"Generic SCSI-1 tape"}, \
 	{MT_ISSCSI2,		"Generic SCSI-2 tape"}, \
 	{0, NULL} \
diff -ur linux-2.4.0-orig/kernel/ksyms.c linux-2.4.0-test3-pre2/kernel/ksyms.c
--- linux-2.4.0-orig/kernel/ksyms.c	Sat Jul  1 20:53:50 2000
+++ linux-2.4.0-test3-pre2/kernel/ksyms.c	Mon Jul  3 08:41:39 2000
@@ -362,6 +362,7 @@
 EXPORT_SYMBOL(tq_scheduler);
 EXPORT_SYMBOL(timer_active);
 EXPORT_SYMBOL(timer_table);
+EXPORT_SYMBOL(timer_sequence);
 
 #ifdef CONFIG_SMP
 /* Various random spinlocks we want to export */
